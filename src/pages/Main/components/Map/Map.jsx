import React, { useState, useEffect } from 'react';
import './Map.style.css'

const Map = ({selectedDistrict, setSelectedDistrict, availableProducts}) => {
    const [productsCountByLocation, setProductsCountByLocation] = useState({});
    console.log('availableProductsMap', availableProducts);

    useEffect(() => {
        if (!availableProducts || !Array.isArray(availableProducts)) {
            return;
        }
    
        const countProducts = availableProducts.reduce((acc, product) => {
            if (product.available && Array.isArray(product.available)) {
                product.available.forEach(({ locationId }) => {
                    acc[locationId] = (acc[locationId] || 0) + 1;
                });
            }
            return acc;
        }, {});
        
        setProductsCountByLocation(countProducts);
    }, [availableProducts]);


    const handleDistrictClick = (districtId) => {
        setSelectedDistrict(districtId);
    };

    // const isDistrictSelected = (districtId) => {
    //     return selectedDistrict === districtId;
    // };

    const districtCenters = {
        1: { x: 50, y: 50 },
        2: { x: 150, y: 60 },
        3: { x: 250, y: 60 },
    };

    


    return <div className='Map'>
        <>
            <svg viewBox="0 0 499 414" xmlns="http://www.w3.org/2000/svg">
                <path
                    id='19'
                    className={"district" + (selectedDistrict === 19 ? " selected" : "")}
                    style={{ stroke: "rgb(0, 0, 0)" }}
                    d="M 39.43 72.511 L 33.745 68.309 L 26.329 52.242 ..."
                    onClick={() => handleDistrictClick(0)}
                />
                <path id='1' className={"district" + (selectedDistrict === 1 ? " selected" : "")} onClick={() => handleDistrictClick(1)} style={{ Stroke: "rgb(0, 0, 0)" }} d="M 138.051 66.084 L 126.187 51.748 L 127.67 48.782 L 134.591 46.805 L 140.028 48.782 L 142.994 38.895 L 155.106 28.02 L 180.565 57.433 L 197.125 52.242 L 202.563 73.005 L 191.687 77.454 L 195.889 90.307 L 170.183 98.711 L 157.825 106.126 L 160.049 112.305 L 150.41 117.001 L 123.468 73.005 L 130.883 69.545 L 138.051 66.084 Z" />
                {/* <path id='2' className={"district" + (setSelectedDistrict === 2? " selected" : "")}  onClick={() => handleDistrictClick(3)} style={{ Stroke: "rgb(0, 0, 0)" }} d="M 126.187 0.46 L 127.175 5.403 L 140.523 9.358 L 137.062 15.043 L 133.849 24.188 L 141.264 26.66 L 139.04 37.289 L 142.5 38.524 L 154.364 28.143 L 156.589 28.885 L 180.565 56.815 L 197.125 51.625 L 207.259 48.658 L 215.416 47.67 L 221.842 48.411 L 233.459 51.377 L 234.695 43.468 L 239.639 38.772 L 242.11 32.592 L 243.841 23.941 L 239.639 18.009 L 237.661 13.066 L 236.92 9.605 L 228.022 0.707 L 126.187 0.46 Z" /> */}
                <path id='2' className={"district" + (selectedDistrict === 2 ? " selected" : "")}  onClick={() => handleDistrictClick(2)} style={{ Stroke: "rgb(0, 0, 0)" }} d="M 126.187 0.46 L 127.175 5.403 L 140.523 9.358 L 137.062 15.043 L 133.849 24.188 L 141.264 26.66 L 139.04 37.289 L 142.5 38.524 L 154.364 28.143 L 156.589 28.885 L 180.565 56.815 L 197.125 51.625 L 207.259 48.658 L 215.416 47.67 L 221.842 48.411 L 233.459 51.377 L 234.695 43.468 L 239.639 38.772 L 242.11 32.592 L 243.841 23.941 L 239.639 18.009 L 237.661 13.066 L 236.92 9.605 L 228.022 0.707 L 126.187 0.46 Z" />
                <path id='3' className={"district" + (selectedDistrict === 3 ? " selected" : "")}  onClick={() => handleDistrictClick(3)} style={{ Stroke: "rgb(0, 0, 0)" }} d="M 197.867 51.872 L 207.259 49.153 L 216.899 47.917 L 222.089 48.658 L 233.459 52.119 L 235.19 43.715 L 238.65 40.255 L 241.122 36.794 L 244.582 23.941 L 251.256 26.907 L 255.952 26.907 L 266.333 35.064 L 270.288 28.638 L 283.882 34.817 L 284.377 39.019 L 290.556 43.962 L 284.13 53.602 L 288.331 56.074 L 282.647 66.949 L 272.265 95.621 L 266.333 95.868 L 263.12 100.565 L 259.412 103.778 L 253.48 98.834 L 257.683 92.902 L 255.21 90.925 L 244.829 99.082 L 225.303 81.285 L 196.384 90.183 L 191.934 77.33 L 203.304 73.376 L 197.867 51.872 Z" />
                <path id='4' className={"district" + (selectedDistrict === 4 ? " selected" : "")}  onClick={() => handleDistrictClick(4)} style={{ Stroke: "rgb(0, 0, 0)" }} d="M 283.002 67.152 L 285.522 70.617 L 308.674 91.88 L 321.589 94.558 L 330.882 96.92 L 335.449 100.385 L 325.054 109.52 L 311.982 120.86 L 298.122 133.933 L 294.499 141.965 L 292.137 141.65 L 265.677 117.238 L 266.307 112.828 L 262.212 111.253 L 258.274 107.473 L 255.439 109.205 L 246.934 107.158 L 240.319 106.843 L 240.949 103.378 L 251.974 94.558 L 255.282 91.723 L 257.329 93.14 L 253.706 98.338 L 260.322 104.165 L 263.472 101.015 L 266.375 96.3 L 272.284 96.098 L 283.002 67.152 Z" />
                <path id='5' className={"district" + (selectedDistrict === 5 ? " selected" : "")}  onClick={() => handleDistrictClick(5)} style={{ Stroke: "rgb(0, 0, 0)" }} d="M 336.553 100.543 L 341.593 102.59 L 347.105 105.11 L 354.823 105.74 L 358.446 101.803 L 363.958 97.55 L 370.101 101.645 L 375.613 105.898 L 369.943 150.47 L 362.541 148.58 L 353.878 172.835 L 351.358 173.781 L 349.311 178.348 L 347.421 178.663 L 348.051 183.231 L 364.273 184.018 L 365.691 186.066 L 363.801 196.303 L 296.39 173.466 L 302.218 155.668 L 297.808 152.833 L 300.643 143.225 L 295.288 141.178 L 298.28 133.775 L 313.243 120.23 L 327.89 108.103 L 336.553 100.543 Z" />
                <path id='6' className={"district" + (selectedDistrict === 6 ? " selected" : "")}  onClick={() => handleDistrictClick(6)} style={{ Stroke: "rgb(0, 0, 0)" }} d="M 41.037 79.543 L 43.914 91.911 L 45.065 100.683 L 42.763 100.684 L 41.325 105.717 L 52.974 112.62 L 57.001 116.935 L 76.847 126.714 L 95.831 134.192 L 88.352 144.978 L 91.948 153.32 L 95.399 158.065 L 99.426 159.216 L 99.426 162.811 L 101.008 166.263 L 106.329 168.995 L 110.212 169.283 L 126.031 164.537 L 137.249 161.517 L 148.179 158.065 L 160.978 150.156 L 168.025 146.273 L 178.092 141.671 L 191.898 132.61 L 200.958 126.858 L 182.982 112.189 L 169.895 99.102 L 157.67 106.149 L 160.259 112.764 L 150.48 117.51 L 125.168 76.523 L 122.436 73.503 L 113.186 77.335 L 109.637 73.503 L 106.185 68.469 L 87.633 67.75 L 73.396 67.894 L 63.329 68.326 L 53.353 70.327 L 40.175 72.784 L 41.037 79.543 Z" />
                <path id='7' className={"district" + (selectedDistrict === 7 ? " selected" : "")}  onClick={() => handleDistrictClick(7)} style={{ Stroke: "rgb(0, 0, 0)" }} d="M 260.467 118.47 L 255.788 131.024 L 250.766 141.866 L 247.456 149.17 L 246.201 150.653 L 245.402 152.936 L 248.027 157.044 L 254.418 166.517 L 262.521 178.614 L 268.341 188.429 L 271.195 194.363 L 278.156 210.912 L 284.091 207.83 L 288.884 195.733 L 295.047 177.016 L 297.786 168.457 L 301.78 155.447 L 297.329 152.594 L 298.927 149.17 L 300.296 143.235 L 297.443 142.322 L 295.389 141.98 L 292.878 142.665 L 267.314 119.497 L 265.146 117.101 L 265.488 113.22 L 261.836 111.737 L 260.467 118.47 Z" />
                <path id='8' className={"district" + (selectedDistrict === 8 ? " selected" : "")}  onClick={() => handleDistrictClick(8)} style={{ Stroke: "rgb(0, 0, 0)" }} d="M 170.635 99.132 L 170.635 99.132 L 225.043 81.587 L 244.626 100.107 L 240.993 103.031 L 240.195 107.196 L 247.55 107.373 L 255.703 109.766 L 258.184 107.816 L 261.285 110.209 L 260.399 116.855 L 254.864 131.295 L 246.31 149.819 L 244.537 152.3 L 232.929 144.591 L 223.713 137.236 L 213.523 130.413 L 208.915 128.197 L 200.94 126.78 L 183.66 112.779 L 170.635 99.132 Z" />
                <path id='9' className={"district" + (selectedDistrict === 9 ? " selected" : "")} onClick={() => handleDistrictClick(9)}  style={{ Stroke: "rgb(0, 0, 0)" }} d="M 296.602 173.751 L 363.896 196.744 L 359.923 208.541 L 357.395 211.912 L 350.654 219.376 L 348.968 222.024 L 346.681 232.859 L 344.996 246.462 L 345.236 250.916 L 341.143 252.12 L 333.078 252.722 L 326.577 251.518 L 321.401 248.629 L 315.261 243.814 L 310.085 238.998 L 304.306 234.304 L 298.889 230.933 L 293.11 228.164 L 285.406 225.516 L 278.544 210.829 L 284.924 207.458 L 296.602 173.751 Z" />
                <path id='10' className={"district" + (selectedDistrict === 10 ? " selected" : "")} onClick={() => handleDistrictClick(10)}  style={{ Stroke: "rgb(0, 0, 0)" }} d="M 185.017 332.303 L 204.224 251.472 L 247.599 227.1 L 265.847 216.659 L 278.052 211.057 L 285.455 226.063 L 291.657 227.864 L 296.459 229.864 L 302.261 233.866 L 311.864 240.668 L 318.867 247.271 L 324.269 250.872 L 330.872 253.273 L 338.274 253.473 L 348.278 250.872 L 367.885 247.271 L 366.285 275.481 L 365.284 308.894 L 364.084 328.101 L 364.684 344.107 L 367.285 376.519 L 366.085 377.519 L 276.852 341.506 L 232.635 336.104 L 206.425 334.103 L 185.017 332.303 Z" />
                <path id='11' className={"district" + (selectedDistrict === 11 ? " selected" : "")} onClick={() => handleDistrictClick(11)}  style={{ Stroke: "rgb(0, 0, 0)" }} d="M 198.862 245.639 L 195.016 239.794 L 197.016 229.18 L 195.016 229.026 L 190.401 231.795 L 182.403 216.72 L 180.249 217.951 L 179.787 221.028 L 178.711 224.719 L 176.096 229.488 L 178.557 230.719 L 156.449 275.291 C 156.594 275.164 155.951 276.068 149.484 269.021 L 143.485 261.177 L 145.484 258.715 L 144.408 256.254 L 142.254 256.254 L 134.349 265.995 L 125.495 276.849 L 117.445 286.839 L 127.025 299.94 L 137.947 311.477 L 146.1 319.322 L 151.945 322.552 L 161.636 327.013 L 174.684 330.902 L 184.514 332.146 L 193.632 296.863 L 203.784 251.331 L 198.862 245.639 Z" />
                <path id='12' className={"district" + (selectedDistrict === 12 ? " selected" : "")} onClick={() => handleDistrictClick(12)}  style={{ Stroke: "rgb(0, 0, 0)" }} d="M 88.484 217.611 L 93.802 216.765 L 149.28 211.567 L 154.961 204.436 L 152.302 195.129 L 153.027 193.558 L 170.674 196.942 L 181.914 216.402 L 180.101 217.611 L 178.651 219.303 L 179.859 222.325 L 178.409 225.709 L 175.508 229.214 L 178.046 230.664 L 174.662 238.279 L 156.895 274.418 L 153.994 273.451 L 149.159 267.408 L 144.083 261.123 L 145.628 257.895 L 143.237 256.118 L 117.371 286.384 L 109.877 274.66 L 95.494 250.124 L 84.495 231.39 L 88.484 217.611 Z" />
                <path id='13' className={"district" + (selectedDistrict === 13 ? " selected" : "")} onClick={() => handleDistrictClick(13)}  style={{ Stroke: "rgb(0, 0, 0)" }} d="M 89.946 216.983 L 91.191 213.958 L 91.28 208.53 L 90.836 201.59 L 83.717 201.056 L 80.87 197.319 L 75.799 194.116 L 71.439 191.892 L 71.528 190.557 L 75.265 188.6 L 80.069 186.464 L 86.832 182.015 L 90.302 180.859 L 92.971 178.723 L 95.729 174.541 L 98.576 173.474 L 109.787 172.228 L 110.41 171.16 L 110.321 169.559 L 116.105 168.046 L 125.002 165.199 L 138.171 161.462 L 147.157 158.971 L 148.136 159.326 L 169.579 195.451 L 168.6 196.073 L 152.851 193.316 L 151.695 195.362 L 152.941 200.078 L 154.898 204.437 L 149.827 210.754 L 145.378 211.644 L 89.946 216.983 Z" />
                <path id='14' className={"district" + (selectedDistrict === 14 ? " selected" : "")} onClick={() => handleDistrictClick(14)}  style={{ Stroke: "rgb(0, 0, 0)" }} d="M 204.338 250.449 L 218.843 193.878 L 224.645 194.725 L 229.963 190.131 L 240.842 179.252 L 246.403 172.242 L 254.622 166.923 L 266.589 185.538 L 269.853 192.065 L 277.83 210.438 L 267.798 215.153 L 204.338 250.449 Z" />
                <path id='15' className={"district" + (selectedDistrict === 15 ? " selected" : "")} onClick={() => handleDistrictClick(15)}  style={{ Stroke: "rgb(0, 0, 0)" }} d="M 203.913 250.422 L 218.587 193.751 L 212.009 192.486 L 204.798 190.209 L 199.738 187.173 L 194.552 182.113 L 192.401 177.812 L 191.516 172.625 L 190.63 159.343 L 190.883 151.627 L 191.642 144.543 L 193.413 137.838 L 193.793 134.676 L 192.401 132.272 L 178.487 141.886 L 170.77 145.934 L 163.18 149.476 L 147.747 158.584 L 191.263 230.941 L 194.679 228.791 L 197.082 229.044 L 195.311 239.29 L 199.359 245.995 L 203.913 250.422 Z" />
                <path id='16' className={"district" + (selectedDistrict === 16 ? " selected" : "")} onClick={() => handleDistrictClick(16)}  style={{ Stroke: "rgb(0, 0, 0)" }} d="M 193.034 132.209 L 197.208 129.173 L 201.762 127.276 L 209.352 128.541 L 213.527 130.691 L 219.725 134.739 L 227.188 140.685 L 233.007 145.239 L 241.736 151.058 L 245.404 153.335 L 250.844 161.431 L 253.627 167.123 L 250.211 169.779 L 247.049 171.297 L 244.013 174.966 L 237.435 182.303 L 231.489 188.628 L 226.556 192.802 L 224.279 194.573 L 214.412 193.055 L 206.443 190.652 L 201.636 188.375 C 201.693 188.318 197.589 183.946 197.335 184.2 L 194.425 181.67 L 192.781 177.875 L 191.642 171.93 L 190.883 158.648 L 191.642 147.895 L 193.287 138.534 L 194.173 135.245 L 193.034 132.209 Z" />
                <path id='17' className={"district" + (selectedDistrict === 17 ? " selected" : "")} onClick={() => handleDistrictClick(17)}  style={{ Stroke: "rgb(0, 0, 0)" }} d="M 117.918 286.17 L 99.53 257.067 L 84.571 232.469 L 83.611 242.309 L 81.691 246.63 L 77.851 248.55 L 79.291 253.59 L 81.451 259.35 L 75.69 262.95 L 68.73 266.55 L 66.81 268.95 L 58.89 271.35 L 51.21 271.11 L 45.929 269.67 L 41.849 268.71 L 32.969 270.39 L 24.809 272.79 L 26.009 276.63 L 30.329 280.231 L 38.009 293.911 L 36.089 299.671 L 38.489 303.031 L 42.569 304.951 L 52.65 321.272 L 55.53 330.632 L 61.29 340.473 L 67.53 346.473 L 83.851 342.393 L 105.691 339.273 L 123.692 338.073 L 130.892 337.112 L 130.412 348.153 L 132.332 361.353 L 134.972 378.394 L 139.773 378.394 L 146.973 373.834 L 151.293 374.314 L 155.373 376.714 L 159.693 379.834 L 172.174 381.274 L 174.574 368.794 L 178.174 350.313 L 187.774 353.433 L 198.095 359.433 L 212.735 371.434 L 220.655 376.474 L 236.736 381.034 L 242.736 383.914 L 241.776 391.354 L 266.737 404.795 L 267.457 410.075 L 272.497 411.755 L 278.977 411.995 L 286.417 410.075 L 293.618 410.075 L 304.898 399.755 L 311.618 397.835 L 318.339 397.595 L 319.299 413.915 L 378.1 414.155 L 374.5 396.635 L 372.1 386.314 L 369.94 381.514 L 366.58 377.914 L 323.859 361.113 L 276.817 342.153 L 246.096 338.553 L 213.429 335.129 L 192.794 333.477 L 169.177 330.014 L 151.293 322.233 L 140.013 314.312 L 124.892 297.752 L 117.918 286.17 Z" />
                <path id='18' className={"district" + (selectedDistrict === 18 ? " selected" : "")} onClick={() => handleDistrictClick(18)}  style={{ Stroke: "rgb(0, 0, 0)" }} d="M 362.519 149.46 L 354.866 171.803 L 351.824 174.313 L 349.733 178.115 L 347.813 179.07 L 348.386 183.061 L 363.038 183.818 L 365.464 184.767 L 365.509 188.19 L 363.418 198.453 L 361.137 206.058 L 356.956 212.9 L 349.923 222.024 L 347.452 230.958 L 345.931 239.892 L 345.361 245.594 L 345.931 250.727 L 362.468 247.495 L 367.981 247.209 L 367.031 266.693 L 365.7 297.485 L 364.369 327.519 L 365.889 350.328 L 367.455 376.454 L 370.242 375.823 L 375.377 376.108 L 378.815 374.849 L 377.865 363.635 L 380.526 360.023 L 377.675 356.792 L 377.865 351.849 L 381.857 352.99 L 388.509 356.601 L 389.84 370.668 L 394.402 370.477 L 402.576 373.899 L 412.65 378.556 L 443.443 390.531 L 447.815 391.101 L 450.476 389.2 L 461.501 361.828 L 461.881 356.126 L 461.881 352.324 L 457.319 347.192 L 453.898 344.341 L 446.675 355.746 L 444.394 356.316 L 441.923 356.886 L 387.369 336.642 L 386.609 333.411 L 387.559 329.989 L 393.071 316.113 L 394.402 314.213 L 400.295 316.113 L 409.419 319.535 L 415.501 321.626 L 418.733 314.403 L 420.253 309.841 L 415.881 307.179 L 398.584 300.717 L 394.402 296.915 L 394.402 294.634 L 396.303 293.874 L 399.344 296.725 L 402.576 298.816 L 418.162 303.948 L 423.485 304.518 L 425.385 298.056 L 425.956 294.064 L 403.716 285.32 L 401.435 271.444 L 403.146 269.353 L 414.361 273.535 L 417.212 272.394 L 417.972 268.593 L 408.658 264.411 L 400.104 260.039 L 398.964 256.047 L 400.675 253.576 L 405.997 254.527 L 406.757 252.626 L 409.609 251.866 L 409.419 249.204 L 398.584 245.023 L 395.923 242.742 L 397.443 240.08 L 399.154 237.039 L 398.204 234.188 L 395.352 236.659 L 391.551 241.601 L 384.898 236.279 L 383.757 233.428 L 382.617 230.576 L 380.716 226.204 L 380.146 221.262 L 384.708 215.94 L 390.41 214.419 L 398.014 214.419 L 401.625 215.94 L 402.576 219.742 L 404.666 223.163 L 400.485 229.816 L 400.865 231.717 L 402.956 232.097 L 406.757 229.056 L 408.658 230.006 L 439.071 280.948 L 440.782 280.758 L 441.352 274.295 L 443.823 272.965 L 442.683 264.221 L 446.675 262.89 L 448.956 265.932 L 455.418 266.882 L 456.749 264.411 L 460.171 264.221 L 463.592 266.882 L 463.592 272.584 L 460.551 276.387 L 455.989 276.957 L 447.435 299.386 L 451.237 303.188 L 455.989 302.427 L 464.923 280.568 L 466.443 279.427 L 478.609 279.618 L 478.609 290.072 L 485.071 290.642 L 484.501 269.163 L 464.732 262.32 L 449.906 261.75 L 420.474 210.628 L 418.37 208.174 L 409.781 207.123 L 409.431 200.637 L 407.678 185.913 L 404.698 166.457 L 402.945 160.147 L 401.894 155.94 L 401.368 127.193 L 399.79 112.294 L 389.273 112.47 L 379.633 108.789 L 375.601 106.51 L 370.167 150.681 L 362.519 149.46 Z" />
                {/* {Object.entries(productsCountByLocation).map(([locationId, count]) => {
                    const center = districtCenters[locationId];
                    return (
                        center && (
                            <text key={locationId} x={center.x} y={center.y} fill="black">
                                {count}
                            </text>
                        )
                    );
                })} */}
            </svg>
        </>
    </div>
}

export default Map